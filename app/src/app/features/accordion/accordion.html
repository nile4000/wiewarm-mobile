<div class="list-header">
  <div class="search">
    <span class="search-emoji" aria-hidden="true">🔍</span>
    <input
      type="text"
      [(ngModel)]="searchInput"
      placeholder="Suche…"
      aria-label="Badi suchen"
    />
  </div>
</div>

<cdk-virtual-scroll-viewport
  class="item-viewport"
  [itemSize]="72"
  orientation="vertical"
>
  <div class="accordion" cdkAccordion>
    @if(badResource.isLoading()) {
    <div class="status" role="status">
      <span aria-hidden="true">⏳ </span>Laden…
    </div>
    } @if(badResource.error()) {
    <div class="status error" role="alert">
      <span aria-hidden="true">❌ </span>
      Fehler beim Laden: {{ badResource.error()?.message }}. Bitte versuchen Sie
      es später erneut.
    </div>
    } @if(!badResource.isLoading() && !badResource.error() &&
    filteredItems().length === 0) {
    <div class="status" role="status">
      <span aria-hidden="true">😕 </span>Keine Resultate gefunden.
    </div>
    } @for(item of filteredItems(); track item.beckenid; let i = $index) {
    <section class="accordion-item">
      <cdk-accordion-item cdk-accordion-item #accItem="cdkAccordionItem">
        <h3>
          <button
            class="accordion-header"
            (click)="accItem.toggle()"
            type="button"
            [attr.id]="'acc-header-' + i"
            [attr.aria-expanded]="accItem.expanded"
            [attr.aria-controls]="'acc-body-' + i"
          >
            <span class="accordion-header-left">
              <span class="accordion-header-title">{{ item.bad }}</span>
              <span class="accordion-header-subtitle">
                {{ item.plz ? item.plz + ' ' : '' }}{{ item.ort }}
                @if(item.kanton) {
                <img
                  class="kanton-wappen"
                  [src]="'assets/img/wappen/' + (item.kanton | lowercase) + '.svg'"
                  [attr.alt]="(item.kanton | titlecase) + ' Wappen'"
                  width="18"
                  height="18"
                  loading="lazy"
                />}
              </span>
            </span>
            <span class="accordion-header-right">
              <span class="temp-label">
                <span
                  class="temp-dot"
                  [ngClass]="temperatureClass(item.temp)"
                ></span>
                {{ item.temp != null ? item.temp + '°C' : '—' }}
              </span>
            </span>
          </button>
        </h3>
        @if(accItem.expanded) {
        <div
          class="accordion-body"
          role="region"
          [attr.id]="'acc-body-' + i"
          [attr.aria-labelledby]="'acc-header-' + i"
        >
          <div class="accordion-body-left"></div>
          <div class="accordion-body-right">
            <div class="time-label">Aktualisiert: {{ item.date_pretty }}</div>
          </div>
        </div>
        }
      </cdk-accordion-item>
    </section>
    }
  </div>
</cdk-virtual-scroll-viewport>
