<div class="toolbar">
  <button (click)="requestPosition()">Meine Position abrufen</button>

  <div class="filters">
    <label>
      <span class="visually-hidden">Suche</span>
      <input
        type="text"
        [(ngModel)]="searchInput"
        placeholder="Suche…"
        aria-label="Suche"
      />
    </label>

    <div cdkMenuBar>
      <button
        [cdkMenuTriggerFor]="sortMenu"
        class="menu-button"
        aria-label="Sortieren nach"
      >
        Sortieren: {{ sortLabel() }}
      </button>
    </div>
    <ng-template #sortMenu>
      <div cdkMenu class="menu-panel" cdkMenuGroup>
        <button cdkMenuItem (click)="sortBy.set('dist')">Entfernung</button>
        <button cdkMenuItem (click)="sortBy.set('date')">Datum</button>
      </div>
    </ng-template>
  </div>
</div>

<ng-container *ngIf="itemsResource.isLoading()">
  <div class="status" role="status">Lade Bad-Items…</div>
</ng-container>
<ng-container *ngIf="itemsResource.error() as err">
  <div class="status error" role="status">Fehler: {{ err.message }}</div>
</ng-container>

<cdk-virtual-scroll-viewport itemSize="60" class="item-viewport">
  <ul class="item-list">
    <li *cdkVirtualFor="let item of filteredItems()" class="item">
      <strong>{{ item.bad }}</strong> in {{ item.ort }}
      <span class="distance">
        {{ item.dist ? (item.dist | number:'1.0-0') + ' m' : '–' }}
      </span>
    </li>
  </ul>
</cdk-virtual-scroll-viewport>
